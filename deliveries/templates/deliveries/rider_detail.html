{% extends "base.html" %}
{% block content %}
<h1 class="mb-3">Delivery for Order #{{ delivery.order.id }}</h1>

<div class="row g-3">
  <div class="col-12 col-lg-8">
    <div class="card h-100">
      <div class="card-body">
        <h2 class="h5">Restaurant</h2>
        <p class="mb-1">{{ delivery.order.restaurant.name }}</p>
        <p class="text-muted">{{ delivery.order.restaurant.address }}</p>

        <hr>
        <h2 class="h5">Items</h2>
        {% if delivery.order.items.all %}
          <ul class="mb-0">
            {% for it in delivery.order.items.all %}
              <li>{{ it.dish_name }} Ã— {{ it.quantity }}</li>
            {% endfor %}
          </ul>
        {% else %}
          <div class="alert alert-info">No items on this order.</div>
        {% endif %}
      </div>
    </div>
  </div>

  <div class="col-12 col-lg-4">
    <div class="card h-100">
      <div class="card-body">
        <h2 class="h5">Status</h2>
        <div class="mb-2">
          <span class="badge text-bg-secondary">{{ delivery.status }}</span>
        </div>
        <p class="small text-muted mb-3">Assigned at: {{ delivery.assigned_at }}</p>

        <form method="post" action="{% url 'deliveries:rider_pick' delivery.pk %}" class="d-grid gap-2 mb-2">
          {% csrf_token %}
          <button class="btn btn-primary" {% if delivery.status != 'ASSIGNED' %}disabled{% endif %}>Mark as PICKED_UP</button>
        </form>

        <form method="post" action="{% url 'deliveries:rider_deliver' delivery.pk %}" class="d-grid gap-2">
          {% csrf_token %}
          <button class="btn btn-success" {% if delivery.status != 'PICKED_UP' %}disabled{% endif %}>Mark as DELIVERED</button>
        </form>

        <hr>
        <a href="{% url 'deliveries:rider_deliveries' %}" class="btn btn-outline-secondary w-100 mt-2">Back to My deliveries</a>
      </div>
    </div>
  </div>
</div>
{% endblock %}
