{# orders/templates/orders/owner_detail.html #}
{% extends "base.html" %}

{% block content %}
<div class="card">
  <div class="card-body">
    <div class="d-flex justify-content-between align-items-start">
      <h1 class="h4 mb-3">Order #{{ order.id }}</h1>
      {# Badge status #}
      {% with s=order.status %}
        <span class="badge
          {% if s == 'CREATED' %} bg-secondary
          {% elif s == 'PREPARING' %} bg-warning text-dark
          {% elif s == 'READY' %} bg-info text-dark
          {% elif s == 'COMPLETED' %} bg-success
          {% elif s == 'CANCELLED' %} bg-danger
          {% else %} bg-light text-dark
          {% endif %}
        ">{{ s }}</span>
      {% endwith %}
    </div>

    <p class="mb-1"><strong>Customer:</strong> {{ order.user.username }}</p>
    {% if order.restaurant %}<p class="mb-1"><strong>Restaurant:</strong> {{ order.restaurant.name }}</p>{% endif %}
    <p class="mb-3"><strong>Created:</strong> {{ order.created_at }}</p>

    <h5 class="mt-2">Items</h5>
    <ul class="list-group mb-3">
      {% for it in order.items.all %}
        <li class="list-group-item d-flex justify-content-between align-items-center">
          <div>
            <div class="fw-semibold">{{ it.dish_name }}</div>
            <small class="text-muted">Qty: {{ it.quantity }}</small>
          </div>
          <div class="fw-bold">â‚¬ {{ it.unit_price|floatformat:2 }}</div>
        </li>
      {% endfor %}
    </ul>

    <div class="d-flex justify-content-between align-items-center">
      <a href="{% url 'orders:owner_list' %}" class="btn btn-outline-secondary">&larr; Back to orders</a>

    
      {% if order.status == 'CREATED' %}
        <form method="post" class="ms-auto">
          {% csrf_token %}
          <button class="btn btn-primary">Set to PREPARING</button>
        </form>
      {% endif %}
    </div>
  </div>
</div>
{% endblock %}
